
RUNS ./scbi --plan=skipforce lib1

CLEAN-DIFF <<EOF
xxxx/xx/xx xx:xx:xx : Module lib1 marked to be skipped
EOF

RUNS ./scbi --plan=skipforce lib1:force

CLEAN-DIFF <<EOF
xxxx/xx/xx xx:xx:xx : Building lib1 [variant-no-patch] (v1)
xxxx/xx/xx xx:xx:xx : native x86_64-linux-gnu
xxxx/xx/xx xx:xx:xx : steps : setup config build install wrapup
xxxx/xx/xx xx:xx:xx : get sources from git
xxxx/xx/xx xx:xx:xx : build [variant-no-patch] starting
xxxx/xx/xx xx:xx:xx : build [variant-no-patch] completed
xxxx/xx/xx xx:xx:xx : install [variant-no-patch] starting
xxxx/xx/xx xx:xx:xx : install [variant-no-patch] completed
xxxx/xx/xx xx:xx:xx : copy install into <sandbox>/install
xxxx/xx/xx xx:xx:xx : End Building lib1 [variant-no-patch] (v1)
EOF

RUNS ./scbi --plan=skipforceg lib1

CLEAN-DIFF <<EOF
xxxx/xx/xx xx:xx:xx : Module lib1 marked to be skipped
EOF

RUNS ./scbi --plan=skipforceg lib1:force

CLEAN-DIFF <<EOF
xxxx/xx/xx xx:xx:xx : Building lib1 [variant-no-patch] (v1)
xxxx/xx/xx xx:xx:xx : native x86_64-linux-gnu
xxxx/xx/xx xx:xx:xx : steps : setup config build install wrapup
xxxx/xx/xx xx:xx:xx : no build needed, versions match
xxxx/xx/xx xx:xx:xx : copy install into <sandbox>/install
xxxx/xx/xx xx:xx:xx : End Building lib1 [variant-no-patch] (v1)
EOF

NRUNS ./scbi --plan=skipforcefor --deps mainlib

RUNS ./scbi --plan=skipforcefor mainlib=lib1:force --deps mainlib

CLEAN-DIFF <<EOF
xxxx/xx/xx xx:xx:xx : Building lib1 [variant-no-patch] (v1)
xxxx/xx/xx xx:xx:xx : native x86_64-linux-gnu
xxxx/xx/xx xx:xx:xx : steps : setup config build install wrapup
xxxx/xx/xx xx:xx:xx : no build needed, versions match
xxxx/xx/xx xx:xx:xx : copy install into <sandbox>/install
xxxx/xx/xx xx:xx:xx : End Building lib1 [variant-no-patch] (v1)

xxxx/xx/xx xx:xx:xx : Building mainlib [default] (master)
xxxx/xx/xx xx:xx:xx : native x86_64-linux-gnu
xxxx/xx/xx xx:xx:xx : steps : setup config build install wrapup
xxxx/xx/xx xx:xx:xx : build starting
xxxx/xx/xx xx:xx:xx : build completed
xxxx/xx/xx xx:xx:xx : install starting
xxxx/xx/xx xx:xx:xx : install completed
xxxx/xx/xx xx:xx:xx : copy install into <sandbox>/install
xxxx/xx/xx xx:xx:xx : End Building mainlib [default] (master)
EOF

#  Delete lib1 & mainlib to ensure recompilation later

./scbi --quiet --plan=skipforceuse --purge:only --deps lib1:force mainlib

NRUNS ./scbi --plan=skipforceuse --deps mainlib

RUNS ./scbi --plan=skipforceuse lib1:force --deps mainlib

CLEAN-DIFF <<EOF
xxxx/xx/xx xx:xx:xx : Building lib1 [variant-no-patch] (v1)
xxxx/xx/xx xx:xx:xx : native x86_64-linux-gnu
xxxx/xx/xx xx:xx:xx : steps : setup config build install wrapup
xxxx/xx/xx xx:xx:xx : build [variant-no-patch] starting
xxxx/xx/xx xx:xx:xx : build [variant-no-patch] completed
xxxx/xx/xx xx:xx:xx : install [variant-no-patch] starting
xxxx/xx/xx xx:xx:xx : install [variant-no-patch] completed
xxxx/xx/xx xx:xx:xx : copy install into <sandbox>/install
xxxx/xx/xx xx:xx:xx : End Building lib1 [variant-no-patch] (v1)

xxxx/xx/xx xx:xx:xx : Building mainlib [default] (master)
xxxx/xx/xx xx:xx:xx : native x86_64-linux-gnu
xxxx/xx/xx xx:xx:xx : steps : setup config build install wrapup
xxxx/xx/xx xx:xx:xx : build starting
xxxx/xx/xx xx:xx:xx : build completed
xxxx/xx/xx xx:xx:xx : install starting
xxxx/xx/xx xx:xx:xx : install completed
xxxx/xx/xx xx:xx:xx : copy install into <sandbox>/install
xxxx/xx/xx xx:xx:xx : End Building mainlib [default] (master)
EOF
