
function darktable-vcs()
{
    echo git
    echo http://github.com/darktable-org/darktable.git
}

function darktable-out-of-tree()
{
    echo true
}

function darktable-env()
{
    system-compiler
    export PERL5LIB=.
}

function darktable-config()
{
    PREFIX=$1
    TARGET=$2

    if [ -d "$GINST" ]; then
        GPOPTS="-DGPHOTO2CONFIG_EXECUTABLE=$GINST/bin/gphoto2-config \
        -DGPHOTO2_INCLUDE_DIR=$GINST/include \
        -DGPHOTO2_LIBRARY=$GINST/lib/libgphoto2.so \
        -DGPHOTO2_PORT_LIBRARY=$GINST/lib/libgphoto2_port.so"
    fi

    if [ -d "$LINST" ]; then
       GPOPTS="$GOPT -DLENSFUN_INCLUDE_DIR=$LINST/include/lensfun \
        -DLENSFUN_LIBRARY=$LINST/lib/liblensfun.so.1"
    fi

    cmake -DCMAKE_BUILD_TYPE=Release $GPOPTS \
      -DCMAKE_INSTALL_PREFIX=$PREFIX \
          -DCMAKE_CXX_FLAGS_RELEASE="-Werror -O3 -DNDEBUG" \
          -DCMAKE_C_FLAGS_RELEASE="-Werror -O3 -DNDEBUG" \
          ../src
}

function darktable-build()
{
    PREFIX=$1
    TARGET=$2

    make -j4
}

function darktable-install()
{
    PREFIX=$1
    TARGET=$2

    make install
}

function darktable-prefix()
{
    echo /opt/darktable
}
