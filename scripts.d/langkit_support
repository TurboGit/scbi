
function langkit_support-vcs()
{
    echo default
    echo none
    echo git
    echo https://github.com/AdaCore/libadalang
}

function langkit_support-depends()
{
    echo gnatcoll-bindings-iconv
    echo libyaml-dev
    echo langkit
    echo xmlada
}

function langkit_support-env()
{
    add-to-var QUEX_PATH /opt/quex/quex-0.65.4
    add-to-var LIBLANG_SUPPORT_EXTERNALLY_BUILT false
}

function langkit_support-out-of-tree()
{
    echo false
}

function langkit_support-config()
{
    local PREFIX=$1
    local TARGET=$2

    [ ! -d langkit ] && mkdir langkit
    rsync -a --exclude=".git" $SCBI_BDIR/langkit/src/* langkit

    export PYTHONPATH=$PWD/langkit
    python ada/manage.py generate
}

function langkit_support-build()
{
    local PREFIX=$1
    local TARGET=$2

    GOPTS="-p -m -j$SCBI_JOBS"

    PRJ=./build/lib/gnat/langkit_support.gpr

    for KIND in static relocatable static-pic; do
        gprbuild $GOPTS -XLIBRARY_TYPE=$KIND -XXMLADA_BUILD=$KIND $PRJ
    done
}

function langkit_support-install()
{
    local PREFIX=$1
    local TARGET=$2

    gprinstall --prefix=$PREFIX --uninstall langkit_support

    GOPTS="-p --prefix=$PREFIX"

    PRJ=./build/lib/gnat/langkit_support.gpr

    for KIND in static relocatable static-pic; do
        gprinstall $GOPTS -XLIBRARY_TYPE=$KIND \
                   -XXMLADA_BUILD=$KIND --build-name=$KIND $PRJ
    done
}
