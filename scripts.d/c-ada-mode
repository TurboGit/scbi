
function c-ada-mode-vcs()
{
    echo none
    echo none
    echo git
    echo https://github.com/emacsmirror/ada-mode.git
}

function c-ada-mode-out-of-tree()
{
    echo false
}

function c-ada-mode-build-depends()
{
    echo c-sandbox
    echo c-wisi-token
}

function c-ada-mode-pre-build()
{
    local PREFIX=$1
    local TARGET=$2
    local VARIANT=$3

    wisitoken-bnf-generate --output_bnf ada_annex_p.wy

    re2c --no-generation-date --debug-output \
         --input custom -W -Werror --utf-8 \
         -o ../src/ada_annex_p_re2c.c \
         ada_annex_p.re2c
}

function c-ada-mode-build()
{
    local PREFIX=$1
    local TARGET=$2
    local VARIANT=$3

    gprbuild -p -j$SCBI_JOBS ada_mode_wisi_parse.gpr
}

function c-ada-mode-pre-install()
{
    local PREFIX=$1
    local TARGET=$2
    local VARIANT=$3

    #  Fix name of install txt file
    sed -i 's/_p_lr1_parse_table.txt/_p_lr1_re2c_parse_table.txt/g' \
        ada_mode_wisi_parse.gpr
}

function c-ada-mode-install()
{
    local PREFIX=$1
    local TARGET=$2
    local VARIANT=$3

    gprinstall -q -p --mode:usage --prefix=$PREFIX \
               ada_mode_wisi_parse.gpr
}

function c-ada-mode-prefix()
{
    echo $HOME/.local
}
